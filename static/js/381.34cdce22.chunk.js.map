{"version":3,"file":"static/js/381.34cdce22.chunk.js","mappings":"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","sources":["Components/SortByButton.tsx","Components/SolidColoredToggleButton.tsx","Components/ToggleButton/ElementToggle.tsx","Components/ToggleButton/WeaponToggle.tsx","PageCharacter/CharacterSelectionModal.tsx"],"sourcesContent":["import { faSortAmountDownAlt, faSortAmountUp } from \"@fortawesome/free-solid-svg-icons\";\nimport { FontAwesomeIcon } from \"@fortawesome/react-fontawesome\";\nimport { Button, ButtonGroup, ButtonGroupProps, MenuItem } from \"@mui/material\";\nimport { Box } from \"@mui/system\";\nimport { Trans, useTranslation } from \"react-i18next\";\nimport DropdownButton from \"./DropdownMenu/DropdownButton\";\n\n// Assumes that all the sortKeys has corresponding translations in ui.json sortMap\nexport default function SortByButton<Key extends string>({ sortKeys, value, onChange, ascending, onChangeAsc, ...props }: ButtonGroupProps & {\n  sortKeys: Key[]\n  value: Key\n  onChange: (value: Key) => void\n  ascending: boolean\n  onChangeAsc: (value: boolean) => void\n}) {\n  const { t } = useTranslation(\"ui\")\n  return <Box display=\"flex\" alignItems=\"center\" gap={1}>\n    <Trans t={t} i18nKey={t(\"sortBy\") as any}>Sort by: </Trans>\n    <ButtonGroup {...props} >\n      <DropdownButton title={<Trans t={t} i18nKey={t(`sortMap.${value}`) as any}>{{ value: t(`sortMap.${value}`) }}</Trans>}>\n        {sortKeys.map(key =>\n          <MenuItem key={key} selected={value === key} disabled={value === key} onClick={() => onChange(key)}>{t(`sortMap.${key}`) as any}</MenuItem>)}\n      </DropdownButton>\n      <Button onClick={() => onChangeAsc(!ascending)} startIcon={<FontAwesomeIcon icon={ascending ? faSortAmountDownAlt : faSortAmountUp} className=\"fa-fw\" />}>\n        {ascending ? <Trans t={t} i18nKey=\"ascending\" >Ascending</Trans> : <Trans t={t} i18nKey=\"descending\" >Descending</Trans>}\n      </Button>\n    </ButtonGroup>\n  </Box>\n}\n","import { ButtonProps, ToggleButton, ToggleButtonProps, styled } from \"@mui/material\";\n\ntype SolidColoredToggleButtonPartial = {\n  baseColor?: ButtonProps[\"color\"];\n  selectedColor?: ButtonProps[\"color\"];\n}\nexport type SolidColoredToggleButtonProps = SolidColoredToggleButtonPartial & ToggleButtonProps\n\n\nconst SolidColoredToggleButton = styled(ToggleButton, {\n  shouldForwardProp: (prop) => prop !== \"baseColor\" && prop !== \"selectedColor\"\n})<SolidColoredToggleButtonPartial>(({ theme, baseColor = \"secondary\", selectedColor = \"success\" }) => ({\n  '&': {\n    backgroundColor: theme.palette[baseColor].main,\n    color: theme.palette[baseColor].contrastText,\n  },\n  '&:hover': {\n    backgroundColor: theme.palette[baseColor].dark,\n  },\n  '&.Mui-selected': {\n    backgroundColor: theme.palette[selectedColor].main,\n    color: theme.palette[selectedColor].contrastText,\n  },\n  '&.Mui-selected:hover': {\n    backgroundColor: theme.palette[selectedColor].dark,\n  },\n  '&.Mui-disabled': {\n    backgroundColor: theme.palette[baseColor].dark,\n  },\n  '&.Mui-selected.Mui-disabled': {\n    backgroundColor: theme.palette[selectedColor].dark,\n  },\n}));\n\nexport default SolidColoredToggleButton\n","import { Box, ToggleButtonGroup } from \"@mui/material\";\nimport { allElements, ElementKey } from \"../../Types/consts\";\nimport { handleMultiSelect } from \"../../Util/MultiSelect\";\nimport SolidColoredToggleButton from \"../SolidColoredToggleButton\";\nimport { SolidToggleButtonGroupProps } from \"../SolidToggleButtonGroup\";\nimport StatIcon from \"../StatIcon\";\ntype ElementToggleProps = Omit<SolidToggleButtonGroupProps, \"onChange\" | \"value\"> & {\n  onChange: (value: ElementKey[]) => void\n  value: ElementKey[]\n}\nconst elementHandler = handleMultiSelect([...allElements])\nexport default function ElementToggle({ value, onChange, ...props }: ElementToggleProps) {\n  return <ToggleButtonGroup exclusive value={value} {...props}>\n    {allElements.map(ele => <SolidColoredToggleButton key={ele} value={ele} selectedColor={ele} onClick={() => onChange(elementHandler(value, ele))}>\n      <Box sx={{ fontSize: \"2em\", lineHeight: 1 }}>{StatIcon[ele]}</Box>\n    </SolidColoredToggleButton>)}\n  </ToggleButtonGroup>\n}\n","import { ToggleButton } from \"@mui/material\";\nimport Assets from \"../../Assets/Assets\";\nimport { allWeaponTypeKeys, WeaponTypeKey } from \"../../Types/consts\";\nimport { handleMultiSelect } from \"../../Util/MultiSelect\";\nimport ImgIcon from \"../Image/ImgIcon\";\nimport SolidToggleButtonGroup, { SolidToggleButtonGroupProps } from \"../SolidToggleButtonGroup\";\ntype WeaponToggleProps = Omit<SolidToggleButtonGroupProps, \"onChange\" | \"value\"> & {\n  onChange: (value: WeaponTypeKey[]) => void\n  value: WeaponTypeKey[]\n}\nconst weaponTypeHandler = handleMultiSelect([...allWeaponTypeKeys])\nexport default function WeaponToggle({ value, onChange, ...props }: WeaponToggleProps) {\n  return <SolidToggleButtonGroup exclusive value={value} {...props}>\n    {allWeaponTypeKeys.map(wt => <ToggleButton key={wt} value={wt} onClick={() => onChange(weaponTypeHandler(value, wt))}>\n      <ImgIcon src={Assets.weaponTypes?.[wt]} size={2} />\n    </ToggleButton>)}\n  </SolidToggleButtonGroup>\n}\n","import { Box, CardActionArea, CardContent, Divider, Grid, TextField, Tooltip, tooltipClasses, TooltipProps, Typography } from \"@mui/material\";\nimport { styled } from \"@mui/system\";\nimport { ChangeEvent, useContext, useDeferredValue, useEffect, useMemo, useState } from \"react\";\nimport { useTranslation } from \"react-i18next\";\nimport CardDark from \"../Components/Card/CardDark\";\nimport CardLight from \"../Components/Card/CardLight\";\nimport CharacterCard from \"../Components/Character/CharacterCard\";\nimport CloseButton from \"../Components/CloseButton\";\nimport ModalWrapper from \"../Components/ModalWrapper\";\nimport SortByButton from \"../Components/SortByButton\";\nimport SqBadge from \"../Components/SqBadge\";\nimport { StarsDisplay } from \"../Components/StarDisplay\";\nimport ElementToggle from \"../Components/ToggleButton/ElementToggle\";\nimport WeaponToggle from \"../Components/ToggleButton/WeaponToggle\";\nimport { DataContext } from \"../Context/DataContext\";\nimport CharacterSheet from \"../Data/Characters/CharacterSheet\";\nimport { ascensionMaxLevel } from \"../Data/LevelData\";\nimport { DatabaseContext } from \"../Database/Database\";\nimport useCharacter from \"../ReactHooks/useCharacter\";\nimport useDBMeta from \"../ReactHooks/useDBMeta\";\nimport useForceUpdate from \"../ReactHooks/useForceUpdate\";\nimport usePromise from \"../ReactHooks/usePromise\";\nimport { ICachedCharacter } from \"../Types/character\";\nimport { allCharacterKeys, CharacterKey } from \"../Types/consts\";\nimport { characterFilterConfigs, characterSortConfigs, CharacterSortKey, characterSortMap } from \"../Util/CharacterSort\";\nimport { filterFunction, sortFunction } from \"../Util/SortByFilters\";\n\ntype characterFilter = (character: ICachedCharacter | undefined, sheet: CharacterSheet) => boolean\n\ntype CharacterSelectionModalProps = {\n  show: boolean,\n  newFirst?: boolean\n  onHide: () => void,\n  onSelect?: (ckey: CharacterKey) => void,\n  filter?: characterFilter\n}\nconst sortKeys = Object.keys(characterSortMap)\nexport default function CharacterSelectionModal({ show, onHide, onSelect, filter = () => true, newFirst = false }: CharacterSelectionModalProps) {\n  const { t } = useTranslation([\"page_character\", \"charNames_gen\"])\n  const { database } = useContext(DatabaseContext)\n  const [state, setState] = useState(() => database.displayCharacter.get())\n  useEffect(() => database.displayCharacter.follow((r, s) => setState(s)), [database, setState])\n\n  const characterSheets = usePromise(() => CharacterSheet.getAll, [])\n\n  const [dbDirty, forceUpdate] = useForceUpdate()\n\n  // character favorite updater\n  useEffect(() => database.charMeta.followAny(s => forceUpdate()), [forceUpdate, database])\n\n  const [searchTerm, setSearchTerm] = useState(\"\")\n  const deferredSearchTerm = useDeferredValue(searchTerm)\n  const deferredState = useDeferredValue(state)\n  const deferredDbDirty = useDeferredValue(dbDirty)\n  const characterKeyList = useMemo(() => {\n    if (!characterSheets) return []\n    const { element, weaponType, sortType, ascending } = deferredState\n    const sortByKeys = [...(newFirst ? [\"new\"] : []), ...(characterSortMap[sortType] ?? [])] as CharacterSortKey[]\n    return deferredDbDirty && allCharacterKeys\n      .filter(key => filter(database.chars.get(key), characterSheets[key]))\n      .filter(filterFunction({ element, weaponType, name: deferredSearchTerm }, characterFilterConfigs(database, characterSheets)))\n      .sort(sortFunction(sortByKeys, ascending, characterSortConfigs(database, characterSheets), [\"new\", \"favorite\"]))\n  }, [database, newFirst, deferredState, characterSheets, deferredDbDirty, deferredSearchTerm, filter])\n\n  if (!characterSheets) return null\n\n  const { weaponType, element, sortType, ascending } = state\n\n  return <ModalWrapper open={show} onClose={onHide} sx={{ \"& .MuiContainer-root\": { justifyContent: \"normal\" } }}>\n    <CardDark>\n      <CardContent sx={{ py: 1, display: \"flex\", alignItems: \"center\", gap: 1, flexWrap: \"wrap\" }}>\n        <WeaponToggle sx={{ height: \"100%\" }} onChange={weaponType => database.displayCharacter.set({ weaponType })} value={weaponType} size=\"small\" />\n        <ElementToggle sx={{ height: \"100%\" }} onChange={element => database.displayCharacter.set({ element })} value={element} size=\"small\" />\n        <Box flexGrow={1}>\n          <TextField\n            autoFocus\n            value={searchTerm}\n            onChange={(e: ChangeEvent<HTMLTextAreaElement>) => setSearchTerm(e.target.value)}\n            label={t(\"characterName\")}\n            size=\"small\"\n            sx={{ height: \"100%\" }}\n            InputProps={{\n              sx: { height: \"100%\" }\n            }}\n          />\n        </Box>\n        <SortByButton sx={{ height: \"100%\" }}\n          sortKeys={sortKeys} value={sortType} onChange={sortType => database.displayCharacter.set({ sortType })}\n          ascending={ascending} onChangeAsc={ascending => database.displayCharacter.set({ ascending })} />\n        <CloseButton onClick={onHide} />\n      </CardContent>\n      <Divider />\n      <DataContext.Provider value={{ teamData: undefined } as any}>\n        <CardContent><Grid container spacing={1} columns={{ xs: 2, sm: 3, md: 4, lg: 5, }}>\n          {characterKeyList.map(characterKey => <Grid item key={characterKey} xs={1} >\n            {/* <CharacterCard key={characterKey} hideStats characterKey={characterKey} onClick={() => { onHide(); onSelect?.(characterKey) }} /> */}\n            <SelectionCard characterKey={characterKey} onClick={() => { onHide(); onSelect?.(characterKey) }} />\n          </Grid>)}\n        </Grid></CardContent>\n      </DataContext.Provider>\n    </CardDark>\n  </ModalWrapper>\n}\n\nconst CustomTooltip = styled(({ className, ...props }: TooltipProps) => (\n  <Tooltip {...props} classes={{ popper: className }} />\n))({\n  [`& .${tooltipClasses.tooltip}`]: {\n    padding: 0,\n  },\n});\n\nfunction SelectionCard({ characterKey, onClick }: { characterKey: CharacterKey, onClick: () => void }) {\n  const { gender } = useDBMeta()\n  const characterSheet = usePromise(() => CharacterSheet.get(characterKey, gender), [characterKey, gender])\n  const character = useCharacter(characterKey)\n  const { level = 1, ascension = 0, constellation = 0 } = character ?? {}\n  return <CustomTooltip enterDelay={300} enterNextDelay={300} arrow placement=\"bottom\" title={\n    <Box sx={{ width: 300 }}>\n      <CharacterCard hideStats characterKey={characterKey} />\n    </Box>\n  }>\n    <Box>\n      <CardLight sx={{ flexGrow: 1, display: \"flex\", flexDirection: \"column\" }}>\n        <CardActionArea onClick={onClick}>\n          <Box display=\"flex\"\n            position=\"relative\"\n            className={`grad-${characterSheet?.rarity}star`}\n            sx={{\n              \"&::before\": {\n                content: '\"\"',\n                display: \"block\", position: \"absolute\",\n                left: 0, top: 0,\n                width: \"100%\", height: \"100%\",\n                opacity: 0.5,\n                backgroundImage: `url(${characterSheet?.bannerImg})`, backgroundPosition: \"center\", backgroundSize: \"cover\",\n              }\n            }}\n            width=\"100%\" >\n            <Box flexShrink={1} sx={{ maxWidth: { xs: \"33%\", lg: \"30%\" } }} alignSelf=\"flex-end\" display=\"flex\" flexDirection=\"column\" zIndex={1}>\n              <Box\n                component=\"img\"\n                src={characterSheet?.thumbImg}\n                width=\"100%\"\n                height=\"auto\"\n                maxWidth={256}\n                sx={{ mt: \"auto\" }}\n              />\n            </Box>\n            <Box flexGrow={1} sx={{ pr: 1 }} display=\"flex\" flexDirection=\"column\" zIndex={1} justifyContent=\"space-evenly\">\n              <Typography variant=\"body2\" ><SqBadge color={characterSheet?.elementKey} sx={{ opacity: 0.85, textShadow: \"0 0 5px gray\" }}>{characterSheet?.name}</SqBadge></Typography>\n              {character ? <Box sx={{ display: \"flex\", gap: 1, alignItems: \"center\" }}>\n                <Box sx={{ textShadow: \"0 0 5px gray\" }}>\n                  <Typography variant=\"body2\" component=\"span\" whiteSpace=\"nowrap\" >Lv. {level}</Typography>\n                  <Typography variant=\"body2\" component=\"span\" color=\"text.secondary\">/{ascensionMaxLevel[ascension]}</Typography>\n                </Box>\n                <Typography variant=\"body2\" >C{constellation}</Typography>\n              </Box> : <Typography component=\"span\" variant=\"body2\" ><SqBadge>NEW</SqBadge></Typography>}\n              <Typography variant=\"body2\" ><StarsDisplay stars={characterSheet?.rarity ?? 1} colored /></Typography>\n            </Box>\n          </Box>\n        </CardActionArea>\n      </CardLight>\n    </Box>\n  </CustomTooltip>\n}\n"],"names":["SortByButton","sortKeys","value","onChange","ascending","onChangeAsc","props","t","useTranslation","display","alignItems","gap","i18nKey","title","map","key","selected","disabled","onClick","startIcon","icon","faSortAmountDownAlt","faSortAmountUp","className","styled","ToggleButton","shouldForwardProp","prop","theme","baseColor","selectedColor","backgroundColor","palette","main","color","contrastText","dark","elementHandler","handleMultiSelect","allElements","ElementToggle","ToggleButtonGroup","exclusive","ele","Box","sx","fontSize","lineHeight","StatIcon","weaponTypeHandler","allWeaponTypeKeys","WeaponToggle","wt","src","Assets","size","Object","keys","characterSortMap","CharacterSelectionModal","show","onHide","onSelect","filter","newFirst","database","useContext","DatabaseContext","useState","displayCharacter","get","state","setState","useEffect","follow","r","s","characterSheets","usePromise","CharacterSheet","useForceUpdate","dbDirty","forceUpdate","charMeta","followAny","searchTerm","setSearchTerm","deferredSearchTerm","useDeferredValue","deferredState","deferredDbDirty","characterKeyList","useMemo","element","weaponType","sortType","sortByKeys","allCharacterKeys","chars","filterFunction","name","characterFilterConfigs","sort","sortFunction","characterSortConfigs","open","onClose","justifyContent","py","flexWrap","height","set","flexGrow","autoFocus","e","target","label","InputProps","teamData","undefined","container","spacing","columns","xs","sm","md","lg","characterKey","item","SelectionCard","CustomTooltip","classes","popper","tooltipClasses","padding","gender","useDBMeta","characterSheet","character","useCharacter","level","ascension","constellation","enterDelay","enterNextDelay","arrow","placement","width","hideStats","flexDirection","position","rarity","content","left","top","opacity","backgroundImage","bannerImg","backgroundPosition","backgroundSize","flexShrink","maxWidth","alignSelf","zIndex","component","thumbImg","mt","pr","variant","elementKey","textShadow","whiteSpace","ascensionMaxLevel","stars","colored"],"sourceRoot":""}